---
import { Image } from 'astro:assets';
import iconImage from '../images/akatsuki1910.webp';
import SectionWrapper from './SectionWrapper.astro';
---

<script lang="ts" is:inline>
  function updateAge() {
    const ageElement = document.getElementById('age-display');
    if (!ageElement) return;

    const now = new Date();
    const birthDate = new Date(2001, 8 - 1, 16);
    const nowYearBirthDate = new Date(
      now.getFullYear(),
      birthDate.getMonth(),
      birthDate.getDate(),
    );

    const age =
      now.getFullYear() -
      birthDate.getFullYear() -
      (now > nowYearBirthDate ? 0 : 1);

    const sub =
      now - birthDate + now.getTimezoneOffset() * 60000 + 9 * 60 * 60000;

    const seconds = Math.floor(sub / 1000);
    const minutes = Math.floor(seconds / 60);
    const hours = Math.floor(minutes / 60);
    const days = Math.floor(hours / 24);

    ageElement.textContent = `${age}y/o (${days}d ${hours % 24}h ${minutes % 60}m ${seconds % 60}s)`;

    window.requestAnimationFrame(updateAge);
  }
  window.requestAnimationFrame(updateAge);
</script>

<SectionWrapper id="home" isFilled>
  <div class="hero">
    <div class="hero-visual" data-animate>
      <div class="avatar-ring">
        <figure class="avatar">
          <Image
            src={iconImage}
            alt={'akatsuki1910'}
            class="avatar-img"
            loading={'lazy'}
          />
        </figure>
      </div>
    </div>

    <div class="hero-info" data-animate>
      <h1 class="name">
        <span class="name-label">akatsuki1910</span>
        <span class="cursor" aria-hidden="true"></span>
        <span class="material-symbols-outlined verified" translate="no"
          >check</span
        >
      </h1>

      <address class="profile">
        <ul class="profile-list" data-stagger>
          <li class="profile-item">
            <span class="material-symbols-outlined profile-icon" translate="no"
              >face</span
            >
            <p>
              <ruby>中村<rp>(</rp><rt>ナカムラ</rt><rp>)</rp></ruby>
              <ruby>育豊<rp>(</rp><rt>イクト</rt><rp>)</rp></ruby>
            </p>
          </li>
          <li class="profile-item">
            <span class="material-symbols-outlined profile-icon" translate="no"
              >cake</span
            >
            <time datetime="2001-08-16">2001/08/16</time>
          </li>
          <li class="profile-item">
            <span class="material-symbols-outlined profile-icon" translate="no">
              person_search
            </span>
            <p id="age-display" class="age-counter">solve...</p>
          </li>
          <li class="profile-item">
            <span class="material-symbols-outlined profile-icon" translate="no"
              >mail</span
            >
            <a href="mailto:akatsukicirno@gmail.com">akatsukicirno@gmail.com</a>
          </li>
        </ul>
      </address>
    </div>
  </div>
</SectionWrapper>

<style lang="scss">
  @keyframes ring-rotate {
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes blink {
    0%,
    100% {
      opacity: 1;
    }

    50% {
      opacity: 0;
    }
  }

  .hero {
    display: flex;
    flex-direction: column;
    gap: 40px;
    align-items: center;
    justify-content: center;
    width: 100%;
    max-width: 640px;
    margin: 0 auto;
  }

  .hero-visual {
    position: relative;
  }

  .avatar-ring {
    position: relative;
    padding: 3px;
    background: conic-gradient(
      $color-accent,
      transparent 30%,
      $color-accent 70%,
      transparent
    );
    border-radius: 50%;
    animation: ring-rotate 4s linear infinite;

    &::before {
      position: absolute;
      inset: 3px;
      content: '';
      background: $color-bg;
      border-radius: 50%;
    }
  }

  .avatar {
    position: relative;
    z-index: 1;
    width: 180px;
    height: 180px;
    margin: 0;
    overflow: hidden;
    border-radius: 50%;

    @include is-sp {
      width: 140px;
      height: 140px;
    }

    &-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }

  .hero-info {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
  }

  .name {
    display: flex;
    gap: 8px;
    align-items: center;
    margin: 0;
    font-family: 'JetBrains Mono', monospace;
    font-size: 2rem;
    font-weight: 700;
    letter-spacing: -0.02em;

    @include is-sp {
      font-size: 1.5rem;
    }
  }

  .name-label {
    background: linear-gradient(
      90deg,
      $color-text 0%,
      $color-text-secondary 100%
    );
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .cursor {
    display: inline-block;
    width: 2px;
    height: 1.2em;
    background: $color-accent;
    animation: blink 1s step-end infinite;
  }

  .verified {
    font-size: 24px;
    color: $color-accent;
  }

  .profile {
    margin-top: 24px;
    font-style: normal;
  }

  .profile-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
    padding: 0;
    margin: 0;
  }

  .profile-item {
    display: flex;
    gap: 12px;
    align-items: center;
    font-size: 0.9rem;
    color: $color-text-secondary;
    list-style: none;

    p,
    time,
    a {
      margin: 0;
    }

    a {
      color: $color-text-secondary;
      transition: color $transition-duration ease;

      &:hover {
        color: $color-accent-hover;
      }
    }
  }

  .profile-icon {
    font-size: 20px;
    color: $color-accent;
  }

  .age-counter {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    font-variant-numeric: tabular-nums;
  }
</style>
