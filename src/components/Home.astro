---
import { Image } from 'astro:assets';
import iconImage from '../images/akatsuki1910.webp';
import SectionWrapper from './SectionWrapper.astro';
---

<script lang="ts" is:inline>
  function updateAge() {
    const ageElement = document.getElementById('age-display');
    if (!ageElement) return;

    const now = new Date();
    const birthDate = new Date(2001, 8 - 1, 16);
    const nowYearBirthDate = new Date(
      now.getFullYear(),
      birthDate.getMonth(),
      birthDate.getDate(),
    );

    const age =
      now.getFullYear() -
      birthDate.getFullYear() -
      (now > nowYearBirthDate ? 0 : 1);

    const sub =
      now - birthDate + now.getTimezoneOffset() * 60000 + 9 * 60 * 60000;

    const seconds = Math.floor(sub / 1000);
    const minutes = Math.floor(seconds / 60);
    const hours = Math.floor(minutes / 60);
    const days = Math.floor(hours / 24);

    ageElement.textContent = `${age}y/o (${days}d,${hours % 24}h,${minutes % 60}m,${seconds % 60}s)`;

    window.requestAnimationFrame(updateAge);
  }
  window.requestAnimationFrame(updateAge);
</script>

<SectionWrapper id="home" isFilled>
  <div class="main">
    <h1 class="icon-wrapper">
      <figure>
        <Image
          src={iconImage}
          alt={'akatsuki1910'}
          class="icon"
          loading={'lazy'}
        />
      </figure>
    </h1>
    <div class="profile">
      <h2>
        <span class="material-symbols-outlined" translate="no">check</span>
      </h2>
      <address>
        <ul class="profile-ul">
          <li class="profile-list">
            <span class="material-symbols-outlined" translate="no">face</span>
            <p>
              <ruby>中村<rp>(</rp><rt>ナカムラ</rt><rp>)</rp></ruby>
              <ruby>育豊<rp>(</rp><rt>イクト</rt><rp>)</rp></ruby>
            </p>
          </li>
          <li class="profile-list">
            <span class="material-symbols-outlined" translate="no">cake</span>
            <time datetime="2001-08-16">2001/08/16</time>
          </li>
          <li class="profile-list">
            <span class="material-symbols-outlined" translate="no">
              person_search
            </span>
            <p id="age-display">solve...</p>
          </li>
          <li class="profile-list">
            <span class="material-symbols-outlined" translate="no">mail</span>
            <a href="mailto:akatsukicirno@gmail.com">akatsukicirno@gmail.com</a>
          </li>
        </ul>
      </address>
    </div>
  </div>
</SectionWrapper>

<style lang="scss">
  .main {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .icon-wrapper {
    max-width: 440px;

    @include is-sp {
      width: 70vw;
    }

    figure {
      margin: 0;
    }
  }

  .icon {
    width: 100%;
    height: auto;
  }

  .profile {
    display: flex;
    flex-direction: column;
    align-items: center;

    &-ul {
      padding: 0;
      margin: 0;
    }

    &-list {
      display: flex;
      flex-direction: row;
      align-items: center;

      & > span {
        margin-right: 10px;
      }

      & > * {
        margin: 2px 0;
      }
    }
  }
</style>
